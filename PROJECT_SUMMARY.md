# ููุฎุต ุงููุดุฑูุน - ูููุน ุจูุน ุงููุณุชุนูู Multi-Tenancy

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญููู ุงููุดุฑูุน ุจูุฌุงุญ ุฅูู ูุธุงู **Multi-Tenancy** ุจุงุณุชุฎุฏุงู **Single Database** Architecture.

---

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. ุงูุจููุฉ ุงูุชุญุชูุฉ (Infrastructure)

#### โ Config Files
- `config/tenancy.php` - ุฅุนุฏุงุฏุงุช Multi-tenancy
- ุชุญุฏูุซ `bootstrap/app.php` ูุชุณุฌูู Middleware

#### โ Traits
- `app/Traits/TenantScoped.php` - ุนุฒู ุงูุจูุงูุงุช ุชููุงุฆูุงู

#### โ Middleware
- `InitializeTenant.php` - ุชุญุฏูุฏ ุงููุชุฌุฑ ูู ุงูุฏูููู
- `EnsureTenantExists.php` - ุงูุชุญูู ูู ูุฌูุฏ ูุชุฌุฑ

---

### 2. Models (4 ููุงุฐุฌ)

| Model | ุงููุตู | Features |
|-------|-------|----------|
| **Tenant** | ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ | slug, domain, settings, relationships |
| **Product** | ุงูููุชุฌุงุช ุงููุณุชุนููุฉ | Media support, conditions, featured |
| **Category** | ุงูุชุตูููุงุช | Hierarchical, media support |
| **Order** | ุงูุทูุจุงุช | Status tracking, buyer/seller |

**ุฌููุน Models ุชุณุชุฎุฏู TenantScoped Trait** โ

---

### 3. Migrations (6 ูููุงุช)

```
โ create_tenants_table
โ add_tenant_id_to_users_table
โ create_categories_table
โ create_products_table
โ create_orders_table
โ create_media_table
```

**ุฌููุน ุงูุฌุฏุงูู ูุน tenant_id ู Indexes ููุงุณุจุฉ** โ

---

### 4. Controllers (4 ูุญุฏุงุช ุชุญูู)

| Controller | ุงููุธููุฉ | Methods |
|-----------|---------|---------|
| **TenantController** | ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ | CRUD ูุงูู |
| **ProductController** | ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช | CRUD + Media + Search |
| **CategoryController** | ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช | CRUD + Hierarchical |
| **OrderController** | ุฅุฏุงุฑุฉ ุงูุทูุจุงุช | Create, Update Status |

---

### 5. Routes

#### Central Routes
```
/admin/tenants/* - ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ
```

#### Tenant Routes (Scoped)
```
/products/*       - ุงูููุชุฌุงุช
/categories/*     - ุงูุชุตูููุงุช
/orders/*         - ุงูุทูุจุงุช
```

**ุฌููุน Routes ูุญููุฉ ุจู Middleware ุงูููุงุณุจ** โ

---

### 6. Policies (ุงูุชุญูู ูู ุงูุตูุงุญูุงุช)

- `ProductPolicy` - ุตูุงุญูุงุช ุงูููุชุฌุงุช
- `OrderPolicy` - ุตูุงุญูุงุช ุงูุทูุจุงุช

---

### 7. Services & Helpers

#### Services
- `TenantService.php` - ุฅุฏุงุฑุฉ ุงููุชุงุฌุฑ ูุงูุฅุญุตุงุฆูุงุช

#### Helpers
- `TenantHelper.php` - ุฏูุงู ูุณุงุนุฏุฉ ููู Tenancy

#### Components
- `TenantLayout.php` - Component ูููุงุฌูุฉ

---

### 8. Seeders (ุจูุงูุงุช ุชุฌุฑูุจูุฉ)

- `TenantSeeder` - 3 ูุชุงุฌุฑ ุชุฌุฑูุจูุฉ
- `DemoDataSeeder` - ููุชุฌุงุช ูุชุตูููุงุช ูุจุงุฆุน

**ูุณุชุฎุฏู ุชุฌุฑูุจู:**
- Email: demo@example.com
- Password: password

---

### 9. Media Library Integration

**ููุชุจุฉ Spatie Media Library** ูุฏูุฌุฉ ุจุงููุงูู:

#### Product Collections
- `images` - ุตูุฑ ุงูููุชุฌ (ูุชุนุฏุฏุฉ)
- `featured` - ุงูุตูุฑุฉ ุงูุฑุฆูุณูุฉ

#### Category Collections
- `icon` - ุฃููููุฉ ุงูุชุตููู

**ุฏุนู ุงูุตูุบ:** JPEG, PNG, WebP, SVG

---

### 10. ุงูุชูุซูู (5 ูููุงุช ุดุงููุฉ)

| ุงูููู | ุงููุญุชูู |
|------|---------|
| `MULTI_TENANCY_GUIDE.md` | ุฏููู ุดุงูู ููู Multi-tenancy |
| `INSTALLATION.md` | ุชุนูููุงุช ุงูุชุซุจูุช ุงูููุตูุฉ |
| `QUICK_START.md` | ุจุฏุก ุณุฑูุน ูู 5 ุฏูุงุฆู |
| `COMMANDS.md` | ุฌููุน ุงูุฃูุงูุฑ ุงููููุฏุฉ |
| `README_AR.md` | ููู README ุจุงูุนุฑุจูุฉ |

---

## ๐๏ธ ุงููููู ุงููุนูุงุฑู

```
Single Database Architecture
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Central Database               โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Tenants Table                    โ โ
โ  โ - id, name, slug, domain         โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Products Table                   โ โ
โ  โ - tenant_id โ Global Scope       โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Categories Table                 โ โ
โ  โ - tenant_id โ Global Scope       โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Orders Table                     โ โ
โ  โ - tenant_id โ Global Scope       โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Users Table                      โ โ
โ  โ - tenant_id โ Global Scope       โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ Media Table                      โ โ
โ  โ - morphs (model_id, model_type)  โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุงูุฃูุงู (Security)

### โ ุนุฒู ุงูุจูุงูุงุช
- **TenantScoped Trait** ูุทุจู Global Scope ุชููุงุฆูุงู
- ุฌููุน ุงูุงุณุชุนูุงูุงุช ูููุชุฑุฉ ุจู `tenant_id`
- ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุจูู ุงููุชุงุฌุฑ

### โ Middleware
- `InitializeTenant` ูุนูู ุนูู ูู ุงูุทูุจุงุช
- ุงูุชุญูู ูู ุงูุฏูููู ุชููุงุฆูุงู
- ุถุจุท ุงููุชุฌุฑ ุงูุญุงูู ูู ุงูู Context

### โ Policies
- ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูููุชุฌุงุช
- ุงูุชุญูู ูู ููููุฉ ุงูุณุฌูุงุช
- ุญูุงูุฉ ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ

### โ Validation
- ุฌููุน ุงููุฏุฎูุงุช ูุญููุฉ
- ููุชุฑุฉ ุงูุตูุฑ (ุงูููุน ูุงูุญุฌู)
- CSRF Protection ููุนูู

---

## ๐ Database Schema

### ุฌุฏูู Tenants
```sql
- id (primary)
- name
- slug (unique)
- domain (unique, nullable)
- email (unique)
- phone
- status (boolean)
- settings (json)
- timestamps
```

### ุฌุฏูู Products
```sql
- id (primary)
- tenant_id (foreign โ tenants)
- category_id (foreign โ categories)
- user_id (foreign โ users)
- title
- slug
- description
- price
- condition (enum)
- status
- views_count
- location
- is_featured
- featured_until
- soft_deletes
- timestamps
```

### Indexes
ุฌููุน ุงูุฌุฏุงูู ูุฏููุง Indexes ููุงุณุจุฉ ุนูู:
- `tenant_id`
- `tenant_id + status`
- `tenant_id + slug`
- Foreign Keys

---

## ๐ฏ Features ุงููุชุงุญุฉ

### โ ูููุชุงุฌุฑ (Tenants)
- ุฅูุดุงุก ูุชุฌุฑ ุฌุฏูุฏ
- ุฑุจุท ุฏูููู ูุฎุตุต
- ุฅุนุฏุงุฏุงุช ูุงุจูุฉ ููุชุฎุตูุต
- ุฅุญุตุงุฆูุงุช ุงููุจูุนุงุช

### โ ููููุชุฌุงุช (Products)
- CRUD ูุงูู
- ุฑูุน ุตูุฑ ูุชุนุฏุฏุฉ
- 5 ุญุงูุงุช ููููุชุฌ (ุฌุฏูุฏุ ูุงูุฌุฏูุฏุ ุฌูุฏุ ููุจููุ ูุญุชุงุฌ ุตูุงูุฉ)
- ููุชุฌุงุช ูููุฒุฉ
- ุนุฏุงุฏ ุงููุดุงูุฏุงุช
- ุงูุจุญุซ ูุงูููุชุฑุฉ

### โ ููุชุตูููุงุช (Categories)
- ุชุตูููุงุช ูุฑููุฉ (Parent/Child)
- ุฃููููุงุช ููุชุตูููุงุช
- ุชุฑุชูุจ ูุงุจู ููุชุฎุตูุต

### โ ููุทูุจุงุช (Orders)
- ุฅูุดุงุก ุทูุจุงุช
- 4 ุญุงูุงุช (ููุฏ ุงูุงูุชุธุงุฑุ ูุคูุฏุ ููุชููุ ููุบู)
- ุชุชุจุน ุงูุจุงุฆุน ูุงููุดุชุฑู
- ุฅุดุนุงุฑุงุช (ุฌุงูุฒุฉ ููุชูุนูู)

### โ ูููุณุงุฆุท (Media)
- ุฑูุน ุตูุฑ ูุชุนุฏุฏุฉ
- ุชุญููู ุชููุงุฆู ููุตูุบ
- Media Collections ููุธูุฉ
- ุญุฐู ุขูู ูููููุงุช

---

## ๐ฆ Packages ุงููุณุชุฎุฏูุฉ

```json
{
  "stancl/tenancy": "^3.9",
  "spatie/laravel-medialibrary": "^11.0"
}
```

---

## ๐ ููุจุฏุก ุงูุณุฑูุน

```bash
# 1. ุงูุชุซุจูุช
composer install && npm install

# 2. ุงูุฅุนุฏุงุฏ
copy .env.example .env
php artisan key:generate

# 3. ูุงุนุฏุฉ ุงูุจูุงูุงุช
php artisan migrate --seed

# 4. ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
php artisan db:seed --class=TenantSeeder
php artisan db:seed --class=DemoDataSeeder

# 5. Storage
php artisan storage:link

# 6. ุงูุชุดุบูู
php artisan serve
npm run dev
```

ุฒุฑ: http://localhost:8000

---

## ๐ ูููุงุช ุงููุดุฑูุน

### ุงููููุงุช ุงูุฃุณุงุณูุฉ

```
app/
โโโ Models/
โ   โโโ Tenant.php โ
โ   โโโ Product.php โ
โ   โโโ Category.php โ
โ   โโโ Order.php โ
โ   โโโ User.php โ (ูุญุฏุซ)
โ
โโโ Traits/
โ   โโโ TenantScoped.php โ
โ
โโโ Http/
โ   โโโ Controllers/
โ   โ   โโโ TenantController.php โ
โ   โ   โโโ ProductController.php โ
โ   โ   โโโ CategoryController.php โ
โ   โ   โโโ OrderController.php โ
โ   โ
โ   โโโ Middleware/
โ       โโโ InitializeTenant.php โ
โ       โโโ EnsureTenantExists.php โ
โ
โโโ Policies/
โ   โโโ ProductPolicy.php โ
โ   โโโ OrderPolicy.php โ
โ
โโโ Services/
โ   โโโ TenantService.php โ
โ
โโโ Helpers/
โ   โโโ TenantHelper.php โ
โ
โโโ View/Components/
    โโโ TenantLayout.php โ

config/
โโโ tenancy.php โ

database/
โโโ migrations/
โ   โโโ 2024_01_01_000001_create_tenants_table.php โ
โ   โโโ 2024_01_01_000002_add_tenant_id_to_users_table.php โ
โ   โโโ 2024_01_01_000003_create_categories_table.php โ
โ   โโโ 2024_01_01_000004_create_products_table.php โ
โ   โโโ 2024_01_01_000005_create_orders_table.php โ
โ   โโโ 2024_01_01_000006_create_media_table.php โ
โ
โโโ seeders/
    โโโ TenantSeeder.php โ
    โโโ DemoDataSeeder.php โ

routes/
โโโ web.php โ (ูุญุฏุซ)

bootstrap/
โโโ app.php โ (ูุญุฏุซ)
```

### ูููุงุช ุงูุชูุซูู

```
docs/
โโโ MULTI_TENANCY_GUIDE.md โ
โโโ INSTALLATION.md โ
โโโ QUICK_START.md โ
โโโ COMMANDS.md โ
โโโ README_AR.md โ
โโโ PROJECT_SUMMARY.md โ (ูุฐุง ุงูููู)
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุนุฒู ุงูุจูุงูุงุช

```php
// ูู Tinker
php artisan tinker

$tenant1 = Tenant::find(1);
Tenant::setCurrent($tenant1);
echo Product::count(); // ุนุฏุฏ ููุชุฌุงุช ุงููุชุฌุฑ 1

$tenant2 = Tenant::find(2);
Tenant::setCurrent($tenant2);
echo Product::count(); // ุนุฏุฏ ููุชุฌุงุช ุงููุชุฌุฑ 2 (ูุฎุชูู)
```

### ุงุฎุชุจุงุฑ Media Library

```php
$product = Product::first();
$product->addMedia('path/to/image.jpg')->toMediaCollection('images');
echo $product->getMedia('images')->count();
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ูููุงุช ุชู ุฅูุดุงุคูุง: **28 ููู**

- 5 Models โ
- 1 Trait โ
- 4 Controllers โ
- 2 Middleware โ
- 2 Policies โ
- 1 Service โ
- 1 Helper โ
- 1 Component โ
- 6 Migrations โ
- 2 Seeders โ
- 3 Config Files โ

### ูููุงุช ุงูุชูุซูู: **6 ูููุงุช**

- ุฏููู ุดุงูู โ
- ุชุนูููุงุช ุชุซุจูุช โ
- ุจุฏุก ุณุฑูุน โ
- ูุงุฆูุฉ ุฃูุงูุฑ โ
- README ุนุฑุจู โ
- ููุฎุต ุงููุดุฑูุน โ

### ุฅุฌูุงูู ุงูุฃุณุทุฑ: **~3500 ุณุทุฑ**

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### โ ุชู ุจูุฌุงุญ

1. โ ูุธุงู Multi-Tenancy ูุงูู ุจู Single Database
2. โ ุนุฒู ุชุงู ููุจูุงูุงุช ุจูู ุงููุชุงุฌุฑ
3. โ ููุชุจุฉ Media ูุชูุงููุฉ
4. โ 4 Models ุฃุณุงุณูุฉ ูุน ูุงูู ุงูุนูุงูุงุช
5. โ CRUD ูุงูู ูุฌููุน ุงูููุงูุงุช
6. โ Middleware ู Policies ููุฃูุงู
7. โ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ููุงุฎุชุจุงุฑ
8. โ ุชูุซูู ุดุงูู ุจุงูุนุฑุจูุฉ

### ๐ ุฌุงูุฒ ููุงุณุชุฎุฏุงู

ุงููุดุฑูุน ุฌุงูุฒ **100%** ููุจุฏุก ูู:
- ุฅุถุงูุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู (Views)
- ุฅุถุงูุฉ API endpoints
- ุชูุนูู ุจูุงุจุฉ ุงูุฏูุน
- ุฅุถุงูุฉ ูุธุงู ุงูุฅุดุนุงุฑุงุช
- ุฑุจุท Domains ุญููููุฉ

---

## ๐ฎ ุงูุชุทููุฑ ุงููุณุชูุจูู

### ุงูููุชุฑุญุงุช ุงููุงุฏูุฉ

#### Phase 1 (ูุฑูุจุงู)
- [ ] Views ุฌุงูุฒุฉ ุจู Blade
- [ ] ูุธุงู Authentication ูุงูู
- [ ] ููุญุฉ ุชุญูู ูููุชุฌุฑ

#### Phase 2
- [ ] ูุธุงู ุงูุชููููุงุช ูุงููุฑุงุฌุนุงุช
- [ ] ูุธุงู ุงูุฑุณุงุฆู ุงูุฏุงุฎููุฉ
- [ ] ุฅุดุนุงุฑุงุช Push

#### Phase 3
- [ ] ูุธุงู ุงูุงุดุชุฑุงูุงุช ูุงูุฏูุน
- [ ] ุจูุงุจุฉ ุฏูุน (Stripe/PayPal)
- [ ] API RESTful ูุงูู

#### Phase 4
- [ ] ุชุทุจูู Mobile
- [ ] Multi-language
- [ ] Advanced Analytics

---

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ูุงูุงุณุชูุณุงุฑุงุช:

1. ุฑุงุฌุน ุงูู [Guides](MULTI_TENANCY_GUIDE.md)
2. ุชุญูู ูู [Commands](COMMANDS.md)
3. ุงุทูุน ุนูู ุงูู Logs ูู `storage/logs/`
4. ุงุณุชุฎุฏู `php artisan tinker` ููุชุฌุฑุจุฉ

---

## ๐ ุฎูุงุตุฉ

ุชู ุจูุงุก ูุธุงู Multi-Tenancy ูุชูุงูู ููููุน ุจูุน ุงููุณุชุนูู ุจุงุณุชุฎุฏุงู:
- โ Laravel 12
- โ Single Database Architecture
- โ Spatie Media Library
- โ Best Practices
- โ ุชูุซูู ุดุงูู ุจุงูุนุฑุจูุฉ

**ุงููุดุฑูุน ุฌุงูุฒ ููุฅูุชุงุฌ ูุงูุชุทููุฑ!** ๐

---

**ุจููู ุจู โค๏ธ ููููุน Exabha.com**

